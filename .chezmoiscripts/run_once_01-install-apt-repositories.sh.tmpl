{{ if eq .chezmoi.os "linux" -}}
#!/bin/bash
set -euo pipefail

echo "Setting up APT repositories..."

# Install prerequisites
sudo apt update
sudo apt install -y curl wget gnupg software-properties-common apt-transport-https

# GitHub CLI repository
if [ ! -f /usr/share/keyrings/githubcli-archive-keyring.gpg ]; then
    echo "Adding GitHub CLI repository..."
    curl -fsSL https://cli.github.com/packages/githubcli-archive-keyring.gpg | sudo gpg --dearmor -o /usr/share/keyrings/githubcli-archive-keyring.gpg
    echo "deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/githubcli-archive-keyring.gpg] https://cli.github.com/packages stable main" | sudo tee /etc/apt/sources.list.d/github-cli.list > /dev/null
fi

# Neovim repository
if command -v add-apt-repository &> /dev/null; then
    echo "Adding Neovim PPA..."
    sudo add-apt-repository -y ppa:neovim-ppa/unstable
fi

# Docker repository
if [ ! -f /usr/share/keyrings/docker-archive-keyring.gpg ]; then
    echo "Adding Docker repository..."
    curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo gpg --dearmor -o /usr/share/keyrings/docker-archive-keyring.gpg
    echo "deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/docker-archive-keyring.gpg] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable" | sudo tee /etc/apt/sources.list.d/docker.list > /dev/null
fi

sudo apt update
{{ end -}}

